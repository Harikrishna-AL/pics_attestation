<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="Assets/css/Admin_common.css">
<script src="Assets/js/message.js" defer></script>

<title>Insert Attestation Data</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background:#eef1f6; font-family:system-ui; }
.sidebar { width:240px; background:#e8f0fe; height:100vh; padding:20px; position:fixed; left:0; top:0; box-shadow:4px 0 10px rgba(0,0,0,0.08);} 
.content-area { margin-left:260px; padding:40px 50px; }
.card-box { background:#fff; border-radius:14px; padding:25px 30px; box-shadow:0 6px 20px rgba(0,0,0,0.08);} 
.submit-btn { background:#2563eb; color:#fff; padding:10px; width:160px; border-radius:8px; border:none; font-weight:600; }
 .logo {
      width: 80px;
      margin-bottom: 15px;
    }
    
.back-circle {
    background: #3a3a3a;      /* dark grey */
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ffffff;           /* white arrow */
    font-size: 18px;
    cursor: pointer;
    transition: 0.2s ease;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.back-circle:hover {
    background: #2b2b2b;
}

.back-circle:active {
    transform: scale(0.92);
}
.logout-btn {
    position: absolute;
    top: 15px;        /* place near top */
    right: 20px;      /* place at right */
    background: #ff4d4f;
    border: none;
    color: white;
    padding: 8px 15px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 5px;
    z-index: 9999;    /* ensure stays above content */
}
.title-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 16px;
}

.title-row h3 {
    margin: 0;
    flex-shrink: 0;   /* prevents title from pushing button down */
}

.insert-link {
    font-size: 15px;
    font-weight: 600;
    color: #6366f1;
    cursor: pointer;
    padding: 6px 12px;
    border-radius: 8px;
    background: #eef2ff;
    border: 1px solid #c7d2fe;
    transition: 0.2s ease-in-out;
    white-space: nowrap;
    flex-shrink: 0;
    margin-right: 280;    /* ← moves button slightly left */
}


.insert-link:hover {
    background: #dbe4ff;
    color: #4338ca;
    border-color: #818cf8;
    transform: translateY(-1px);
}

body {
    padding-top: 20px; /* pushes content down so logout button won't overlap */
}


</style>
</head>
<body>
<div class="sidebar">
  <h5 class="fw-bold mb-4"></h5>
  <div class="mb-3 fw-bold text-primary">Insert Data</div>
      <img src="images/pics_logo.jpg" alt="Company Logo" class="logo">

</div>

<div class="content-area">
  <button id="backBtn" class="back-circle" onclick="goBack()">←</button>
    <button class="logout-btn" id="logoutBtn">Logout</button>

 <div class="title-row">
    <h3 class="fw-bold">Insert New Attestation Record</h3>

    <div class="insert-link" onclick="goToView()">
        ➕ Click here to View data
    </div>
</div>



  <div class="card-box">
    <div class="row g-3">

      <div class="col-md-4">
        <label>Tracking Number</label>
        <input id="TrackingNumber" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Submitted By</label>
        <input id="Submittedby" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Date of Submission</label>
        <input type="date" id="DateofSubmission" class="form-control" />

      </div>

      <div class="col-md-4">
        <label>Status</label>
        <input id="Status" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Type</label>
        <input id="Type" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Customer Name</label>
        <input id="CustomerName" class="form-control" />
      </div>

      <div class="col-md-6">
        <label>Document Details</label>
        <input id="DocumentDetails" class="form-control" />
      </div>

      <div class="col-md-6">
        <label>General Comments</label>
        <input id="GeneralComments" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Phone No</label>
        <input id="phoneno" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Payment Mode</label>
        <input id="PaymentMode" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Total Amount</label>
        <input id="TotalAmount" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>UAE Delivery Charges</label>
        <input id="UaeDeliveryCharges" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Advance Paid</label>
        <input id="AdvancePaid" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Balance</label>
        <input id="Balance" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Passport Number</label>
        <input id="PassportNumber" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Submitted Document 1</label>
        <input id="SubmittedDocument1" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Submitted Document 2</label>
        <input id="SubmittedDocument2" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Submitted Document 3</label>
        <input id="SubmittedDocument3" class="form-control" />
      </div>

      <div class="col-md-6">
        <label>Other Docs</label>
        <input id="OtherDocs" class="form-control" />
      </div>

      <div class="col-md-6">
        <label>UAE Number Releasing Date</label>
        <input id="UaeNumberReleasingDate" class="form-control" />
      </div>

      

      <div class="col-md-4">
        <label>Date Process</label>
        <input id="DateProcess" class="form-control" type="date" />
      </div>

      <div class="col-md-4">
        <label>Delivered</label>
        <input id="Delivered" class="form-control" />
      </div>

      <div class="col-md-4">
        <label>Submitted</label>
        <input id="Submitted" class="form-control" />
      </div>

      
      <div class="col-md-4">
        <label>COUNTRY</label>
        <input id="COUNTRY" class="form-control" />
      </div>

      <div class="col-12 mt-4">
        <button class="submit-btn" onclick="submitData()">Submit</button>
      </div>

    </div>
  </div>
</div>
  <!-- Supabase client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Your global config -->
  <script src="Assets/js/supabaseConfig.js"></script>
  <script src="Assets/js/Logout.js"></script>

  <script>

  supabase.auth.getSession().then(({ data: { session } }) => {
    if (!session) {
        window.location.href = "Login_Admin.html";
        return;
    }

    // ROLE-BASED BACK BUTTON CONTROL
    const role = session.user.user_metadata?.role;

    if (role === "staff") {
        // hide back button for staff
        const backBtn = document.getElementById("backBtn");
        if (backBtn) backBtn.style.display = "none";
    } 
    else {
        // show back button for admin
        const backBtn = document.getElementById("backBtn");
        if (backBtn) backBtn.style.display = "inline-block";
    }
});
document.getElementById("logoutBtn")?.addEventListener("click", logoutUser);

    </script>

<script>
  

function submitData() {
  
  const requiredFields = [
    "TrackingNumber",
    "Submittedby",
    "DateofSubmission",
    "Status",
    "Type",
    "CustomerName",
    "DocumentDetails",
    "GeneralComments",
    "phoneno",
    "PaymentMode",
    "TotalAmount",
    "UaeDeliveryCharges",
    "AdvancePaid",
    "Balance",
    "PassportNumber",
    "SubmittedDocument1",
    "SubmittedDocument2",
    "SubmittedDocument3",
    "OtherDocs",
    "UaeNumberReleasingDate",
    "Delivered",
    "COUNTRY"
  ];

  let isValid = true;
  let firstInvalid = null;

  //  Reset borders first
  requiredFields.forEach(id => {
    document.getElementById(id).style.border = "1px solid #ccc";
  });

  //  Check empty fields
  requiredFields.forEach(id => {
    const el = document.getElementById(id);
    if (!el.value.trim()) {
      isValid = false;
      el.style.border = "2px solid red";
      if (!firstInvalid) firstInvalid = el;
    }
  });

  if (!isValid) {
    //alert("Please fill all required fields.");
showError('Failed!', 'Please fill all required fields.', { autoCloseMs: 5000 });

nvalid.scrollIntoView({ behavior: "smooth", block: "center" });
    firstInvalid.focus();
    return;
  }

  const apiUrl ="https://script.google.com/macros/s/AKfycbwmXI284lkBIw4eYCFQLY8p0kxGb4XxVS9d3LQ7ANyMTYG0LcqvsWmYmJLkX6XxRnlb/exec";
  const data = {
    TrackingNumber: document.getElementById("TrackingNumber").value,
    Submittedby: document.getElementById("Submittedby").value,
    DateofSubmission: document.getElementById("DateofSubmission").value,
    Status: document.getElementById("Status").value,
    Type: document.getElementById("Type").value,
    CustomerName: document.getElementById("CustomerName").value,
    DocumentDetails: document.getElementById("DocumentDetails").value,
    GeneralComments: document.getElementById("GeneralComments").value,
    phoneno: document.getElementById("phoneno").value,
    PaymentMode: document.getElementById("PaymentMode").value,
    TotalAmount: document.getElementById("TotalAmount").value,
    UaeDeliveryCharges: document.getElementById("UaeDeliveryCharges").value,
    AdvancePaid: document.getElementById("AdvancePaid").value,
    Balance: document.getElementById("Balance").value,
    PassportNumber: document.getElementById("PassportNumber").value,
    SubmittedDocument1: document.getElementById("SubmittedDocument1").value,
    SubmittedDocument2: document.getElementById("SubmittedDocument2").value,
    SubmittedDocument3: document.getElementById("SubmittedDocument3").value,
    OtherDocs: document.getElementById("OtherDocs").value,
    UaeNumberReleasingDate: document.getElementById("UaeNumberReleasingDate").value,
    DateProcess: document.getElementById("DateProcess").value,
    Delivered: document.getElementById("Delivered").value,
    Submitted: document.getElementById("Submitted").value,
    COUNTRY: document.getElementById("COUNTRY").value,
    PassCode: "none",
    TYPE:"none"
  };

  fetch(apiUrl, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify(data),
    headers: {
      "Content-Type": "application/json"
    }
  })
  .then(() => {
  //alert("Data submitted successfully!");
showSuccess('Saved!', 'Data submitted successfully!');

  clearForm();
})
.catch(err => {
  //alert("Request failed: " + err);
  showError('Failed!', 'Request failed:', { autoCloseMs: 5000 });

});
}

function clearForm() {
  document.getElementById("TrackingNumber").value = "";
  document.getElementById("Submittedby").value = "";
  document.getElementById("DateofSubmission").value = "";
  document.getElementById("Status").value = "";
  document.getElementById("Type").value = "";
  document.getElementById("CustomerName").value = "";
  document.getElementById("DocumentDetails").value = "";
  document.getElementById("GeneralComments").value = "";
  document.getElementById("phoneno").value = "";
  document.getElementById("PaymentMode").value = "";
  document.getElementById("TotalAmount").value = "";
  document.getElementById("UaeDeliveryCharges").value = "";
  document.getElementById("AdvancePaid").value = "";
  document.getElementById("Balance").value = "";
  document.getElementById("PassportNumber").value = "";
  document.getElementById("SubmittedDocument1").value = "";
  document.getElementById("SubmittedDocument2").value = "";
  document.getElementById("SubmittedDocument3").value = "";
  document.getElementById("OtherDocs").value = "";
  document.getElementById("UaeNumberReleasingDate").value = "";
  document.getElementById("DateProcess").value = "";
  document.getElementById("Delivered").value = "";
 document.getElementById("Submitted").value = ""; 
  document.getElementById("COUNTRY").value = "";
}
function goBack(){ window.location.href = 'Dashboard_Admin.html'; }
function goToView() {
    window.location.href = "ViewData_Admin.html";
}



</script>
<!-- your form, inputs, page UI here -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, "0");
    const dd = String(today.getDate()).padStart(2, "0");

    // Set ISO value so browser can display correctly
    document.getElementById("DateofSubmission").value = `${yyyy}-${mm}-${dd}`;
});
</script>


</body>
</html>


</body>
</html>
