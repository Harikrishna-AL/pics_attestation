<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Status Report</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.16.0/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/number-to-words"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VLBZ70LB11">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VLBZ70LB11');
</script>


  <style>
    /* body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f9f9f9;
    } */
    .container_status {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }

    .section_status {
      margin-bottom: 20px;
      border: 1px solid #f2dede;
      border-radius: 4px;
      background-color: #b2ceeb;
      padding: 15px;
    }

    .section_status h3 {
      margin: 0 0 10px;
      color: #1d7ad1;
    }

    .section_status .row_status {
      display: flex;
      justify-content: space-between;
      padding: 5px 0;
      border-bottom: 1px solid #f9dcdc
    }

    .section_status .row_status:last-child {
      border-bottom: none;
    }

    .row_status .label {
      display: block;
      width: 45%;
      font-size: 14px;
    }

    .row_status .label {
      font-weight: bold;
    }

    .input-section {
      margin-bottom: 20px;
      text-align: center;
    }

    .input-section input {
      padding: 10px;
      width: 70%;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-right: 10px;
    }

    .input-section button {
      padding: 10px 15px;
      background-color: #1d7ad1;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .input-section button:hover {
      background-color: #7fa2c4;
    }

    body {
      font-family: Arial, sans-serif;
    }

    .hidden {
      display: none;
    }

    .button-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
    }
  </style>
  <link rel="shortcut icon" type="image/x-icon" href="images/company/pics_logo.jpg" />


  <!-- bootstrap.min css -->
  <link rel="stylesheet" href="plugins/bootstrap/bootstrap.min.css">
  <!-- Ionic Icon Css -->
  <link rel="stylesheet" href="plugins/Ionicons/css/ionicons.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- animate.css -->
  <link rel="stylesheet" href="plugins/animate-css/animate.css">
  <!-- Magnify Popup -->
  <link rel="stylesheet" href="plugins/magnific-popup/magnific-popup.css">
  <!-- Slick CSS -->
  <link rel="stylesheet" href="plugins/slick/slick.css">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header class="navigation">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <nav class="navbar navbar-expand-lg p-0">
            <a class="navbar-brand" href="index.html">
              <img src="images/company/pics_logo.jpg" alt="Logo">
              PICS.
            </a>

            <button class="navbar-toggler collapsed" type="button" data-toggle="collapse"
              data-target="#navbarsExample09" aria-controls="navbarsExample09" aria-expanded="false"
              aria-label="Toggle navigation">
              <span class="ion-android-menu"></span>
            </button>

            <div class="collapse navbar-collapse ml-auto" id="navbarsExample09">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="index.html">Home</a>
                </li>


                <li class="nav-item dropdown @@attestation">
                  <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">Attestation <span class="ion-ios-arrow-down"></span></a>
                  <ul class="dropdown-menu" aria-labelledby="dropdown04">
                    <li><a class="dropdown-item @@certificateAttestation"
                        href="pages/attestation/certificate_attestation.html">Certificate
                        Attestation</a></li>
                    <li><a class="dropdown-item @@certificateEquivalency"
                        href="pages/attestation/certificate_equivalency.html">Certificate Equivalency</a></li>
                    <li class="dropdown dropdown-submenu dropright"><a class="dropdown-item dropdown-toggle"
                        id="dropdown0301" role="button" href="" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">Educational Certificate</a>
                      <ul class="dropdown-menu" aria-labelledby="dropdown0301">
                        <li><a class="dropdown-item @@educationCertificate"
                            href="pages/attestation/educational_certificate.html">Education Certificate</a></li>
                        <li><a class="dropdown-item @@degreeCertificate"
                            href="pages/attestation/degree_certificate.html">Degree Certificate</a></li>
                        <li><a class="dropdown-item @@diplomaCertificate"
                            href="pages/attestation/diploma_certificate.html">Diploma Certificate</a></li>
                        <li><a class="dropdown-item @@hscCertificate" href="pages/attestation/hsc_certificate.html">HSC
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate"
                            href="pages/attestation/sslc_certificate.html">SSLC Certificate</a></li>
                      </ul>
                    </li>
                    <li class="dropdown dropdown-submenu dropright"><a class="dropdown-item dropdown-toggle"
                        id="dropdown0301" role="button" href="" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">Non - Educational Certificate</a>
                      <ul class="dropdown-menu" aria-labelledby="dropdown0301">
                        <li><a class="dropdown-item @@educationCertificate"
                            href="pages/attestation/non_educational_certificate.html">Non - Educational Certificate</a>
                        </li>
                        <li><a class="dropdown-item @@degreeCertificate" href="pages/attestation/marriage.html">Marriage
                            Certificate</a></li>
                        <li><a class="dropdown-item @@diplomaCertificate" href="pages/attestation/death.html">Death
                            Certificate</a></li>
                        <li><a class="dropdown-item @@hscCertificate" href="pages/attestation/birth.html">Birth
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/divorce.html">Divorce
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/salary.html">Salary
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/exp.html">Experience
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/transfer.html">Transfer
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/pcc.html">PCC
                            Attestation</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/medical.html">Medical
                            Certificate</a></li>
                      </ul>
                    </li>
                    <!-- <li><a class="dropdown-item @@nonEducationalCertificate"
                        href="non-educational-certificate.html">Non-Educational Certificate</a></li> -->
                    <li><a class="dropdown-item @@commercialCertificate"
                        href="pages/attestation/commercial_certificate.html">Commercial
                        Certificate</a></li>
                    <li><a class="dropdown-item @@meaAttestation" href="pages/attestation/mea_attestation.html">MEA
                        Attestation</a></li>
                    <li><a class="dropdown-item @@mofaAttestation" href="pages/attestation/mofa_attestaion.html">MOFA
                        Attestation</a>
                    </li>
                  </ul>
                </li>

                <li class="nav-item dropdown @@apostile">
                  <a class="nav-link dropdown-toggle" href="#" id="dropdown05" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">Apostile <span class="ion-ios-arrow-down"></span></a>
                  <ul class="dropdown-menu" aria-labelledby="dropdown05">
                    <li><a class="dropdown-item @@certificateApostile"
                        href="pages/apostile/certificate_apostile.html">Certificate
                        Apostile</a></li>
                    <li class="dropdown dropdown-submenu dropright"><a class="dropdown-item dropdown-toggle"
                        id="dropdown0301" role="button" href="" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">Educational Certificate</a>
                      <ul class="dropdown-menu" aria-labelledby="dropdown0301">
                        <li><a class="dropdown-item @@educationCertificate"
                            href="pages/attestation/educational_certificate.html">Education Certificate</a></li>
                        <li><a class="dropdown-item @@degreeCertificate"
                            href="pages/attestation/degree_certificate.html">Degree Certificate</a></li>
                        <li><a class="dropdown-item @@diplomaCertificate"
                            href="pages/attestation/diploma_certificate.html">Diploma Certificate</a></li>
                        <li><a class="dropdown-item @@hscCertificate" href="pages/attestation/hsc_certificate.html">HSC
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate"
                            href="pages/attestation/sslc_certificate.html">SSLC Certificate</a></li>
                      </ul>
                    </li>
                    <li class="dropdown dropdown-submenu dropright"><a class="dropdown-item dropdown-toggle"
                        id="dropdown0301" role="button" href="" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">Non - Educational Certificate</a>
                      <ul class="dropdown-menu" aria-labelledby="dropdown0301">
                        <li><a class="dropdown-item @@educationCertificate"
                            href="pages/attestation/non_educational_certificate.html">Non - Educational Certificate</a>
                        </li>
                        <li><a class="dropdown-item @@degreeCertificate" href="pages/attestation/marriage.html">Marriage
                            Certificate</a></li>
                        <li><a class="dropdown-item @@diplomaCertificate" href="pages/attestation/death.html">Death
                            Certificate</a></li>
                        <li><a class="dropdown-item @@hscCertificate" href="pages/attestation/birth.html">Birth
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/divorce.html">Divorce
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/salary.html">Salary
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/exp.html">Experience
                            Certificate</a></li>
                        <li><a class="dropdown-item @@sslcCertificate" href="pages/attestation/transfer.html">Transfer
                            Certificate</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>

                <li class="nav-item dropdown @@pcc">
                  <a class="nav-link dropdown-toggle" href="#" id="dropdown06" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">PCC <span class="ion-ios-arrow-down"></span></a>
                  <ul class="dropdown-menu" aria-labelledby="dropdown06">
                    <li><a class="dropdown-item @@omanPCC" href="pages/pcc/oman_pcc.html">Oman PCC</a></li>
                    <li><a class="dropdown-item @@saudiPCC" href="pages/pcc/saudi-pcc.html">Saudi PCC</a></li>
                    <li><a class="dropdown-item @@kuwaitPCC" href="pages/pcc/kuwait-pcc.html">Kuwait PCC</a></li>
                    <li><a class="dropdown-item @@qatarPCC" href="pages/pcc/quatar-pcc.html">Qatar PCC</a></li>
                    <li><a class="dropdown-item @@uaePCC" href="pages/pcc/uae-pcc.html">UAE PCC</a></li>
                  </ul>
                </li>

                <li class="nav-item dropdown @@portfolio">
                  <a class="nav-link dropdown-toggle" href="#" id="dropdown03" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">Gallery<span class="ion-ios-arrow-down"></span></a>
                  <ul class="dropdown-menu" aria-labelledby="dropdown03">
                    <li><a class="dropdown-item @@portfolioFilter" href="portfolio.html">Photos</a></li>
                    <!-- <li><a class="dropdown-item @@portfolioSingle" href="portfolio-single.html">Portfolio Single</a> -->
                </li>
              </ul>
              </li>

              <li class="nav-item @@contact"><a class="nav-link" href="contact.html">Contact</a></li>
              <li class="nav-item">
                <a class="nav-link" href="https://wa.me/+918369820334" target="_blank">
                  <img src="https://img.icons8.com/ios/50/whatsapp.png" alt="WhatsApp"
                    style="width: 30px; height: 30px;">
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://mail.google.com/mail/?view=cm&fs=1&to=skpradhas@gmail.com"
                  target="_blank">
                  <img src="https://img.icons8.com/ios/50/gmail.png" alt="Email" style="width: 30px; height: 30px;">
                </a>
              </li>

              </ul>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <div class="container_status">
    <!-- Input Tracking Number -->
    <div class="input-section">
      <input type="text" id="trackingNumber" placeholder="Enter Tracking Number">
      <button onclick="fetchData()">Fetch Details</button>
    </div>

    <!-- Document Submitted By -->
    <div class="section_status">
      <h3>Document Submitted By</h3>
      <div class="row_status">
        <span class="label">Submitted by</span>
        <span class="value" id="submittedBy">--</span>
      </div>
    </div>


    <div class="section_status">
      <h3>Date Of Submission</h3>
      <div class="row_status">
        <span class="label">Date Of Submission</span>
        <span id="dateofsubmission">--</span>
      </div>
    </div>


    <!-- Document Status -->
    <div class="section_status">
      <h3>Document Status</h3>
      <div class="row_status">
        <span class="label">Current Status</span>
        <span id="currentStatus">--</span>
      </div>
    </div>

    <!-- Document Details -->
    <div class="section_status">
      <h3>Document Details</h3>
      <div class="row_status">
        <span class="label">Type</span>
        <span id="docType">--</span>
      </div>
      <div class="row_status">
        <span class="label">Name</span>
        <span id="docName">--</span>
      </div>
      <div class="row_status">
        <span class="label">Document Details</span>
        <span id="docDetails">--</span>
      </div>
      <div class="row_status">
        <span class="label">General Comments</span>
        <span id="comments">--</span>
      </div>
      <div class="row_status">
        <span class="label">Passport Number</span>
        <span id="passnumber">--</span>
      </div>
    </div>
  </div>

  <script>
    const excelUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQNdL-odS32YpWW70Zjko2amZg5duTOyf1e7UK-5Z7JTjdousVV09S4Nj8T4NvDcGYEr95KtIx1otBy/pub?output=csv"; // Replace with your direct Google Drive link


function excelDateToJSDate(serial) {
    if (!serial) return "--";

    let utc_days = serial - 25569;
    let utc_value = utc_days * 86400; 
    let d = new Date(utc_value * 1000);

    let day = String(d.getDate()).padStart(2, '0');
    let month = String(d.getMonth() + 1).padStart(2, '0');
    let year = d.getFullYear();

    return `${day}/${month}/${year}`;
}


    function formatExcelDate(excelSerial) {
    if (!excelSerial) return "--"; // Handle empty or undefined values

    // Convert Excel serial date to JavaScript date
    const date = new Date((excelSerial - 25569) * 86400000); // 25569 is the Excel epoch offset

    // Format date as YYYY-MM-DD
    return date.toISOString().split("T")[0];
    }



    async function fetchData() {
      const trackingNumber = document.getElementById("trackingNumber").value.trim();
      if (!trackingNumber) {
        alert("Please enter a tracking number.");
        return;
      }


      try {
        const response = await fetch(excelUrl);
        const data = await response.arrayBuffer();


        const workbook = XLSX.read(data, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];

        // Convert Excel data to JSON
        const jsonData = XLSX.utils.sheet_to_json(sheet);

        // Find the row matching the tracking number
        const userData = jsonData.find(row => row["TrackingNumber"] == trackingNumber);

        if (!userData) {
          alert("No data found for the entered tracking number.");
          return;
        }



        // Populate fields
        console.log(userData)
        document.getElementById("submittedBy").textContent = userData["Submittedby"] || "--";
        document.getElementById("currentStatus").textContent = userData["Status"] || "--";
        userData["DateofSubmission"] = excelDateToJSDate(userData["DateofSubmission"]);
        document.getElementById("dateofsubmission").textContent = userData["DateofSubmission"] || "--";
        document.getElementById("docType").textContent = userData["Type"] || "--";
        document.getElementById("docName").textContent = userData["CustomerName"] || "--";
        document.getElementById("docDetails").textContent = userData["DocumentDetails"];
        document.getElementById("comments").textContent = userData["GeneralComments"] || "--";
        document.getElementById("passnumber").textContent = userData["PassportNumber"] || "--";
      } catch (error) {
        console.error("Error fetching or processing the Excel file:", error);
        alert("Failed to fetch data. Please check the Excel file link.");
      }
    }
  </script>

  <body>


    <div class="button-container">
      <button onclick="downloadPDF()"
        style="background-color:#1d7ad1; color: white; padding: 10px 15px; border: none; cursor: pointer; font-size: 16px; border-radius: 5px;">
        Download Receipt
      </button>
    </div>

    <div id="receipt" class="hidden" stlye="width: 100%">
      <hr>
                                                      <p style="text-align: center;"><strong>Receipt</strong></p>

      <p><strong>Bill No:</strong> <span id="billNo"></span></p>

      <p><strong>Date:</strong> <span id="currentDate"></span></p>

      <p>We received from <span id="customerName"></span> Passport No: <span id="passno"></span> for the purpose of </p>
      <p>Attestation/Medical/Visa RA/Other purposes of Attestation </p>
      <p><strong>of CERTIFICATES</strong></p>

      <p>Attestation of Document From UAE Consulate</p>

      <p>Cost of work UAE = Rs<span id="total"></span></p>
      <p>UAE Delivery Charges = Rs<span id="UAECharge"></span></p>
      <p>Advance Paid = Rs<span id="adv"></span></p>
      <p>Balance = Rs<span id="bal"></span></p>
      <p>PAYMENT MODE = <span id="paymode"></span> </p>
      <p><strong>Amount in words:</strong> <span id="amtwords"></span></p>
      <p>UAE Number = <span id="uaenum"></span></p>
      <p>Processed Date = <span id="processdate"></span></p>
      <p>Submitted Documents:</p>
      <p>1.<span id="subdoc1"></span></p>
      <p>2.<span id="subdoc2"></span></p>
      <p>3.<span id="subdoc3"></span></p>

      <!-- <p style="text-align: right;">Submitted Successfully **********</p> -->
    </div>


    <script>
      document.getElementById("currentDate").innerText = new Date().toLocaleDateString();



      async function downloadPDF() {
  const trackingNumber = document.getElementById("trackingNumber").value;
  const custname = document.getElementById("submittedBy").textContent;
  if (!trackingNumber) {
    alert("Please enter a tracking number.");
    return;
  }

  const excelUrl1 = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQNdL-odS32YpWW70Zjko2amZg5duTOyf1e7UK-5Z7JTjdousVV09S4Nj8T4NvDcGYEr95KtIx1otBy/pub?output=csv";

  const response1 = await fetch(excelUrl1);
  const data1 = await response1.arrayBuffer();

  const workbook1 = XLSX.read(data1, { type: "array" });
  const sheetName1 = workbook1.SheetNames[0];
  const sheet1 = workbook1.Sheets[sheetName1];

  // Convert Excel data to JSON
  const jsonData1 = XLSX.utils.sheet_to_json(sheet1);
  // Find the row matching the tracking number
  const userData1 = jsonData1.find(row => row["TrackingNumber"] == trackingNumber);

  // const enteredPasscode = prompt("Enter the password for this tracking number:");

  // if (enteredPasscode === null) return; // User clicked cancel

  // if (enteredPasscode.toString() !== userData1["PassCode"].toString()) {
  //   alert("Incorrect password!");
  //   return;
  // }

  const submittedBy = document.getElementById("submittedBy").textContent.trim();
  if (submittedBy == "--") {
    alert("Kindly click 'Fetch Details' before proceeding.");
    return;
  }

  // Get data for the receipt
  const customerName = custname;
  const passportNumber = userData1["PassportNumber"]?.toString() || "--";
  const documentType = userData1["TYPE"]?.toString() || "--";
  const totalAmount = userData1["TotalAmount"]?.toString() || "0";
  const uaeCharges = userData1["UaeDeliveryCharges"]?.toString() || "0";
  const advancePaid = userData1["AdvancePaid"]?.toString() || "0";
  const balance = userData1["Balance"]?.toString() || "0";
  const paymentMode = userData1["PaymentMode"]?.toString() || "--";
  const doc1 = userData1["SubmittedDocument1"]?.toString() || "--";
  const doc2 = userData1["SubmittedDocument2"]?.toString() || "--";
  const doc3 = userData1["SubmittedDocument3"]?.toString() || "--";
  const uae_num = userData1["PassCode"]?.toString() || "--";
  const processed_date = userData1["UAENUMBERRELEASINGDATE"]?.toString() || "--";
  const country = userData1["COUNTRY"]?.toString() || "--";

  let amountInWords = "";
  const advance = parseFloat(advancePaid);
  const remaining = parseFloat(balance);

  if (!isNaN(advance) && !isNaN(remaining) && isFinite(advance + remaining)) {
    const total = advance + remaining;
    const words = numberToWords.toWords(Math.floor(total)); // Use Math.floor to avoid decimals
    amountInWords = words.charAt(0).toUpperCase() + words.slice(1) + " Only";
  }

  // Create a formatted tracking number similar to the sample
  const formattedTrackingNumber = `${trackingNumber}`;

  // Get current date or use a specific date for testing
  const dateObj = new Date();
  const day = String(dateObj.getDate()).padStart(2, '0');
  const month = String(dateObj.getMonth() + 1).padStart(2, '0');
  const year = dateObj.getFullYear();
  const formattedDate = `${day}/${month}/${year}`;

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // Set font
  doc.setFont("helvetica");

  // Create a border for the header section
  // doc.rect(20, 20, 170, 40);

  // Add placeholder for the PICS logo
  // doc.rect(22, 22, 36, 36); // Logo placeholder

  // doc.setFontSize(8);
  // doc.text("PICS Logo", 40, 40);
  // add the logo
  const header = new Image();
  header.src = "images/header.jpg"; // Replace with your logo path
  const stamp = new Image();
  stamp.src = "./images/stamp.jpg"; // Replace with your stamp path
  const footer = new Image();
  footer.src = "images/footer.jpg"; // Replace with your footer path
  // logo.onload = function() {
  //   doc.addImage(logo, "JPEG", 22, 22, 36, 36); // Adjust the size and position as needed
  // };
  const qr = new Image();
  qr.src = "images/qr.jpg"; // Replace with your QR code path
  doc.addImage(header, "JPEG", 20, 20, 170, 40); // Logo placeholder

  // Add header content
  // doc.setFontSize(11);
  // doc.setTextColor(0, 0, 255); // Blue text
  // doc.text("Document Attestation, Medical, Visa Stamping - PICS", 63, 25);

  // doc.setFontSize(10);
  // doc.setTextColor(0, 0, 0); // Black text
  // doc.text("Willow Center, 2nd Floor, Alinchuvadu,", 60, 30);
  // doc.text("Arakkakaduvu Road, Vennala,", 60, 35);
  // doc.text("Palarivattom, Cochin â€“ 682028", 60, 40);
  // doc.text("Mob. 8369820334, 9869303751", 60, 45);
  // doc.text("Email: skpradhas@gmail.com, picscochin@gmail.com", 60, 50);
  // doc.setTextColor(0, 0, 255); // Blue text
  // doc.text("Website: https://picsattestation.in", 60, 55);


  // Bill Number and Date
  doc.setTextColor(0, 0, 0); // Black text
  doc.setFontSize(10);
  doc.text(`Bill No: ${formattedTrackingNumber} (Tracking Number)`, 20, 70);

  // RECEIPT title
  doc.setFontSize(14);
  doc.setFont("helvetica", "bold");
  doc.text("RECEIPT", 105, 85, { align: "center" });
  doc.setFont("helvetica", "normal");

  // Date on right side
  doc.setFontSize(10);
  doc.text(`Date: ${formattedDate}`, 170, 85);

  // Receipt content
  doc.text(`We received from Mr./Mrs.. ${customerName}`, 20, 100);
  doc.text(`Passport No: ${passportNumber}`, 202, 100, { align: "right" });
  doc.text(`${country} Embassy/Consulate`, 20, 110);

  // Cost details with aligned equals signs
  doc.text(`Cost of work        ${documentType}`, 20, 125);
  doc.text(`= Rs....${totalAmount} .......`, 120, 125, { align: "left" });

  doc.text(`UAE Delivery Charges`, 20, 130);
  doc.text(`= Rs.....${uaeCharges}.......`, 120, 130, { align: "left" });

  doc.text(`Advance Paid`, 20, 135);
  doc.text(`= Rs .....${advancePaid}......`, 120, 135, { align: "left" });
  doc.text(`PAYMENT MODE : ${paymentMode}`, 190, 135, { align: "right" });

  doc.text(`Balance`, 20, 140);
  doc.text(`= Rs....${balance}......`, 120, 140, { align: "left" });

  // Amount in words
  doc.text(`Amount in words. Rs.. ${amountInWords}.`, 20, 145);

  doc.text(`UAE Number:`, 20, 150);
  doc.text(`= ${uae_num}`, 120, 150)
  doc.text(`Processed Date:`, 20, 155);
  doc.text(`= ${processed_date}`, 120, 155)

  // Submitted documents
  doc.text("Submitted Documents.", 20, 165);
  doc.text(`1... ${doc1}`, 20, 175);
  doc.text(`2... ${doc2}`, 20, 185);
  doc.text(`3... ${doc3}`, 20, 195);

  // Submitted Successfully text
  doc.text("Submitted Successfully *********", 160, 195, { align: "right" });

  // For PICS, Director
  doc.addImage(stamp, 20, 215, 40, 40); // Logo placeholder

  doc.text("Payment Method", 105, 215, { align: "center" });

  // Two rectangles for payment info and QR code
  doc.rect(125, 215, 35, 30); // QR Code placeholder
  // doc.text("QR Code", 142.5, 230, { align: "center" });
  doc.addImage(qr, "JPEG", 126, 216, 27, 27); // Adjust the size and position as needed

  doc.rect(160, 215, 35, 30); // Bank details placeholder
  doc.setFontSize(6);
  doc.text("617301010050483", 177.5, 220, { align: "center" });
  doc.text("Satheesh K", 177.5, 225, { align: "center" });
  doc.text("IFSC: UBIN0561738", 177.5, 230, { align: "center" });
  doc.text("Account type: CC", 177.5, 235, { align: "center" });
  doc.text("Union Bank of India", 177.5, 240, { align: "center" });

  doc.setFontSize(8),
// make font bold and red
  doc.setFont("helvetica", "bold");
  doc.setTextColor(255, 0, 0); // Red text
  doc.text("Note: Any changes in the amount will be paid by the candidate later", 150, 250, { align: "center" });
  

  doc.addImage(footer, "JPEG", 20, 260, 160, 35);

  // Footer - Branch information with color formatting
  // doc.setFontSize(8);
  // doc.setTextColor(255, 0, 0); // Red for "Branches:"
  // doc.text("Branches:", 20, 305);
  // doc.setTextColor(0, 0, 255); // Blue for "Document Attestation..."
  // doc.text("Document Attestation, Medical, Visa Stamping - PICS", 55, 305);

  // doc.setTextColor(255, 0, 0); // Red
  // doc.text("Mumbai", 20, 310);
  // doc.setTextColor(0, 0, 0); // Black
  // doc.text(": 104 Balaji Darshan, Indralok 3, Bhayandar East, Thane 401105, Mumbai", 55, 310);

  // doc.setTextColor(255, 0, 0); // Red
  // doc.text("Cochin", 20, 315);
  // doc.setTextColor(0, 0, 0); // Black
  // doc.text(": Willow Center, 2 nd Floor, Alinchuvadu,Vennala, Palarivattom,Cochin 682026,Kerala", 55, 315);

  // doc.setTextColor(255, 0, 0); // Red
  // doc.text("Kottayam", 20, 320);
  // doc.setTextColor(0, 0, 0); // Black
  // doc.text(": Mulla Building Office Complex D.No.7, Taj Mosque Lane, TB Road, Kottayam 686001", 55, 320);

  // doc.setTextColor(255, 0, 0); // Red
  // doc.text("Alappuzha", 20, 325);
  // doc.setTextColor(0, 0, 0); // Black
  // doc.text(": St. Thomas Evanchalikkal Church Road, Stadium Ward, Alappuzha 688001, Kerala", 55, 325);

  // doc.setTextColor(255, 0, 0); // Red
  // doc.text("Contact", 20, 330);
  // doc.setTextColor(0, 0, 0); // Black
  // doc.text(": 8369820334, 9869303751, 8591870410, 6238875626", 55, 330);

  // Generate the filename with date in a compact format
  const fileDate = `${day}${month}${year}`;
  const fileName = `Receipt_${customerName}_${fileDate}.pdf`;

  // Save the PDF
  doc.save(fileName);
}






//Getting tracking number from viewdata
function getQueryStringValue(key) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(key);
}

window.onload = function () {
    const trackNum = getQueryStringValue("track");

    // Example: Assign to an input field
    const trackInput = document.getElementById("trackingNumber");

    if (trackNum) {
        trackInput.value = trackNum;  // assign value
        fetchData()
    } else {
        trackInput.value = "";        // keep blank
    }

};


    </script>
  </body>


  <script src="plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap 3.1 -->
  <script src="plugins/bootstrap/bootstrap.min.js"></script>
  <!-- slick Carousel -->
  <script src="plugins/slick/slick.min.js"></script>
  <script src="plugins/magnific-popup/jquery.magnific-popup.min.js"></script>
  <!-- filter -->
  <script src="plugins/shuffle/shuffle.min.js"></script>
  <script src="plugins/SyoTimer/jquery.syotimer.min.js"></script>
  <!-- Google Map -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcABaamniA6OL5YvYSpB3pFMNrXwXnLwU&libraries=places"></script>
  <script src="plugins/google-map/map.js"></script>

  <script src="js/script.js"></script>
</body>

</html>
